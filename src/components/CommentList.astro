---
const { pid } = Astro.props;
const res = await fetch(`https://cscd488group3-bloombuddy.netlify.app/.netlify/functions/getComments?pid=${pid}`);
const result = await res.json();

// Defensive fallback if the API returns something unexpected
const comments = Array.isArray(result) ? result : result?.data ?? [];
---

<div class="mt-0 space-y-0">
  {comments.map(comment => (
    <div class="comment bg-white-500 p-2 rounded text-sm">
      <p>{comment.content}</p>
      <p class="text-xs text-gray">â€” {comment.uid}</p>
    </div>
  ))}
</div>
